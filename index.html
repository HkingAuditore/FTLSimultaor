<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FTL</title>

    <!-- 插件 -->
    <script type="text/javascript" src="PlugIn/JQuery.js"></script>
    <script type="text/javascript" src="PlugIn/Popper.js"></script>
    <script type="text/javascript" src="PlugIn/bootstrap/js/bootstrap.bundle.js"></script>
    <script type="text/javascript" src="PlugIn/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="PlugIn/bootstrap/js/bootstrap.js"></script>
    <script type="text/javascript" src="PlugIn/bootstrap/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="PlugIn/bootstrap/css/bootstrap.css" />
    <link rel="stylesheet" href="PlugIn/bootstrap/css/bootstrap-grid.css" />
    <link rel="stylesheet" href="PlugIn/bootstrap/css/bootstrap-grid.min.css" />
    <link rel="stylesheet" href="PlugIn/bootstrap/css/bootstrap-reboot.css" />
    <link rel="stylesheet" href="PlugIn/bootstrap/css/bootstrap-reboot.min.css" />
    <link rel="stylesheet" href="PlugIn/bootstrap/css/bootstrap.min.css" />

    <!-- 插件 -->

    <script type="text/javascript" src="Scripts/Data/Page.js"></script>
    <script type="text/javascript" src="Scripts/Data/Block.js"></script>
    <script type="text/javascript" src="Scripts/Data/Data.js"></script>
    <script type="text/javascript" src="Scripts/FTL/SSD.js"></script>
</head>
<script>
    var ssd = new SSD(256);
    var data = new Data("日月之行，若出其中。", "观沧海");
    ssd.WriteData(data);
    console.log(data.Read());
    console.log(data.ReadIncludeLog());


    data.Edit("对酒当歌，人生几何！");
    console.log("修改为：对酒当歌，人生几何！");
    console.log(data.Read());
    console.log(data.ReadIncludeLog());
    // ssd.FullMerge();
    console.log("");


    data.Edit("呦呦鹿鸣，食野之苹。");
    console.log("修改为：呦呦鹿鸣，食野之苹。");
    console.log(data.Read());
    console.log(data.ReadIncludeLog());
    // ssd.FullMerge();

    // console.log("完全合并：");
    // console.log(data.Read());
    // console.log(data.ReadIncludeLog());
    console.log("");

    data.Edit("月明星稀，乌鹊南飞。绕树三匝，何枝可依？山不厌高，海不厌深。周公吐哺，天下归心。");
    // console.log("修改为：月明星稀，乌鹊南飞。绕树三匝，何枝可依？山不厌高，海不厌深。周公吐哺，天下归心。");
    // console.log(data.Read());
    // console.log(data.ReadIncludeLog());
    // ssd.FullMerge();

    var data1 = new Data("日月之行，若出其中。星汉灿烂，若出其里。", "观沧海");
    ssd.WriteData(data1);

    console.log("展示数据热度：");
    data.blocks.forEach(x => {
        console.log("BLOOM WRITE: " + ssd.BloomHashA(x.num) + "," + ssd.BloomHashB(x.num) + "," + ssd.BloomHashC(x.num))
        console.log(x.num + " : " + ssd.BloomFilterGetter(x.num));
    })
    console.log("展示数据热度：");
    data1.blocks.forEach(x => {
            console.log("BLOOM WRITE: " + ssd.BloomHashA(x.num) + "," + ssd.BloomHashB(x.num) + "," + ssd.BloomHashC(x.num))
            console.log(x.num + " : " + ssd.BloomFilterGetter(x.num));
        })
        // console.log(data.ReadIncludeLog());


    console.log("展示数据热度：");
    ssd.blocksTable.forEach(function(value, key) {
        if (value.Read() !== undefined) {
            console.log(value.Read());
            console.log(key + " : " + ssd.BloomFilterGetter(key));
        } else {
            console.log("EMPTY");

            console.log(key + " : " + ssd.BloomFilterGetter(key));

        }

    })

    // var indicator = new Array(ssd.coldHotIndicator.length).fill(0);
    // ssd.blocksTable.forEach((x) => {
    //     indicator[ssd.BloomHashA(x.num)]++;
    //     indicator[ssd.BloomHashB(x.num)]++;
    //     indicator[ssd.BloomHashC(x.num)]++;
    // })

    // console.log("分布");
    // for (let i in indicator) {
    //     console.log("[" + i + "]" + indicator[i]);

    // }





    // data.EditHybrid("东临碣石，以观沧海。水何澹澹，山岛竦峙。树木丛生，百草丰茂。秋风萧瑟，洪波涌起。日月之行，若出其中。星汉灿烂，若出其里。幸甚至哉，歌以咏志。");


    // console.log(data.ReadIncludeLog());


    // console.log(ssd);
    // console.log(data);
    // ssd.FullMerge();
    // console.log(data.ReadIncludeLog());
    // console.log(data.Read());
</script>

<body></body>

</html>